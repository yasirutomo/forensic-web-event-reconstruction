###############################################################################
# XSS detection (script tag, event handlers, javascript: URL, html entity, url-encoded)
###############################################################################
type=Single
ptype=RegExp
desc=Detect potential XSS payloads in apache access log (script tags, on* handlers, javascript: URLs)
pattern=(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\+\d{2}:\d{2})\s+\S+\s+(?:OS|GZIP):.*evidences[\\/](\S+)\s+http_request:.*?(<(?i:script)\b.*?</(?i:script)>|%3C(?i:script)%3E.*?%3C/%3Cscript%3E|&lt;(?i:script)&gt;.*?&lt;/&lt;script&gt;|(?i:on\w+)\s*=\s*['\"][^'\"]+['\"]|(?i:javascript):)[^\\n]*\s+from:\s+(\S+).*user_agent:\s+([^\r\n]*)
action=write dataset/fer-web-result.log $1 [EXPLOIT: xss_detected] (source: $2) Possible XSS payload matched: $3 — request from $4 — UA: "$5"

###############################################################################
# SQL injection token detection
###############################################################################
type=Single
ptype=RegExp
desc=SQLi token - select
pattern=^(?!.*(?:\[DECODED:|/etc/cron|--cron|/select))(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\+\d{2}:\d{2})\s+\S+\s+(?:OS|GZIP):.*evidences[\\/](\S+)[^\n]*http_request:.*\b[sS][eE][lL][eE][cC][tT]\b
action=write dataset/fer-web-result.log $1 [EXPLOIT: sql_tok_select] (source: $2) select token detected - $0

type=Single
ptype=RegExp
desc=SQLi token - union
pattern=^(?!.*(?:\[DECODED:|/etc/cron|--cron|/union|reunions))(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\+\d{2}:\d{2})\s+\S+\s+(?:OS|GZIP):[^\n]*?evidences[\\/](\S+)[^\n]*http_request:.*[uU][nN][iI][oO][nN]
action=write dataset/fer-web-result.log $1 [EXPLOIT: sql_tok_union] (source: $2) union-fragment $0

type=Single
ptype=RegExp
desc=SQLi token - sleep (time-based)
pattern=^(?!.*(?:\[DECODED:|/etc/cron|--cron))(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\+\d{2}:\d{2})\s+\S+\s+(?:OS|GZIP):.*evidences[\\/](\S+)[^\n]*http_request:.*[sS][lL][eE][eE][pP]\s*\(
action=write dataset/fer-web-result.log $1 [EXPLOIT: sql_tok_sleep] (source: $2) sleep() detected - $0

###############################################################################
# Rule Remote Code Execution (RCE) detection
###############################################################################
type=Single
ptype=RegExp
desc=RCE tag anywhere in line - relaxed
pattern=(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(?:[+-]\d{2}:\d{2})?).*?evidences[\\/](\S+).*?http_request:\s*(.+?)\s+from:\s*(\d{1,3}(?:\.\d{1,3}){3}).*?\[RCE:\s*"([^\]]+)"\]
action=write dataset/fer-web-result.log $1 [EXPLOIT: rce_suspicious] (source: $2) from $4 rce_payload="$5"

###############################################################################
# Rule Remote FIle Inclusion (RFI) detection
###############################################################################
type=Single
ptype=RegExp
desc=Detect embedded PHP tags in HTTP request (literal <?...?> or percent-encoded %3C%3F...%3F%3E)
pattern=(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(?:[+-]\d{2}:\d{2})?).*?evidences[\\/](\S+).*?http_request:.*?(<\?.{0,1000}?\?>|%3C%3F.{0,1500}?%3F%3E).*?from:\s*(\d{1,3}(?:\.\d{1,3}){3})
action=write dataset/fer-web-result.log $1 [EXPLOIT: rfi_suspicious] (source: $2) from $4 php_fragment="$3"

###############################################################################
# Rule RFI generic - parameter value starts with =http:// or =https:// and contains ? or ??
###############################################################################
type=Single
ptype=RegExp
desc=Detect probable RFI where a param is assigned a remote URL starting with http(s) and followed by ? or ??
pattern=(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(?:[+-]\d{2}:\d{2})?).*?evidences[\\/](\S+).*?http_request:.*?(?:=)(https?:\/\/\S*?\?{1,2}\S*).*?from:\s*(\d{1,3}(?:\.\d{1,3}){3})
action=write dataset/fer-web-result.log $1 [EXPLOIT: rfi_generic_http_param] (source: $2) from $4 rfi_url="$3"

###############################################################################
# SSHD: Failed password or Invalid user detection
###############################################################################
type=SingleWithSuppress
ptype=RegExp
desc=SSHD failed login attempts (Failed password / Invalid user)
pattern=(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\+\d{2}:\d{2})\s+\S+\s+(?:OS|GZIP):.*evidences[\\/](\S+)\s+\[sshd\]\s+\[\d+\]:\s+(Failed password|Invalid user|authentication failure).*from\s+(\d+\.\d+\.\d+\.\d+)
action=write dataset/fer-web-result.log $1 [RECON: ssh_suspicious_attempt] (source: $2) $3 from $4
window=10
###############################################################################
# SSHD: succeess password or Invalid user detection
###############################################################################
type=Single
ptype=RegExp
desc=SSHD succeess login attempts (succeess password)
pattern=(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\+\d{2}:\d{2})\s+\S+\s+(?:OS|GZIP):.*evidences[\\/](\S+)\s+\[sshd\]\s+\[\d+\]:\s+(Accepted password|Accepted publickey).*from\s+(\d+\.\d+\.\d+\.\d+)
action=write dataset/fer-web-result.log $1 [PRIV_ESC: ssh_suspicious_success] (source: $2) $3 from $4

###############################################################################
# Succeess password activity
###############################################################################
type=Single
ptype=RegExp
desc=password activity (successful password change)
pattern=(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\+\d{2}:\d{2})\s+\S+\s+(?:OS|GZIP):.*?evidences[\\/](\S+)\s+\[passwd\]\s+\[(\d+)\]:\s+pam_unix\([^\)]*\):\s*(?:password\s+(?:changed|updated|reset))\s+for\s+(\S+)
action=write dataset/fer-web-result.log $1 [PRIV_ESC: passwd_activity] (source: $2) PID:$3 password change for user:$4

###############################################################################
# User deletion activity
###############################################################################
type=Single
ptype=RegExp
desc=User or group deletion activity
pattern=(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\+\d{2}:\d{2})\s+\S+\s+(?:OS|GZIP):.*?evidences[\\/](\S+)\s+\[userdel\]\s+\[(\d+)\]:\s+removed shadow group '([^']+)' owned by '([^']+)'
action=write dataset/fer-web-result.log $1 [PRIV_ESC: userdel_activity] (source: $2) PID:$3 removed shadow group:$4 owned by user:$5

###############################################################################
# User deletion activity (user record)
###############################################################################
type=Single
ptype=RegExp
desc=User deletion activity (userdel)
pattern=(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\+\d{2}:\d{2})\s+\S+\s+(?:OS|GZIP):.*?evidences[\\/](\S+)\s+\[userdel\]\s+\[(\d+)\]:\s*(?:delete|deleted|remove|removed)\s+user\s+'([^']+)'
action=write dataset/fer-web-result.log $1 [PRIV_ESC: userdel_activity] (source: $2) PID:$3 deleted user:$4

###############################################################################
# su - session opened for user detection
###############################################################################
type=Single
ptype=RegExp
desc=SU session opened
pattern=^(?!.*(?:\[CRON|/etc/cron|--cron))(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\+\d{2}:\d{2})\s+\S+\s+(?:OS|GZIP):.*evidences[\\/](\S+).*session opened for user\s+([^\s(]+)\(uid=(\d+)\)\s+by\s+\(uid=(\d+)\)
action=write dataset/fer-web-result.log $1 [PRIV_ESC: sys_session_opened] (source: $2) session opened for user $3 uid=$4 by uid=$5

###############################################################################
# web access to sensitive files (etc/passwd|etc/shadow|etc/group) with 200
###############################################################################
type=Single
ptype=RegExp
desc=Access to /etc/{passwd,shadow,group} returned 200
pattern=(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\+\d{2}:\d{2})\s+\S+\s+(?:OS|GZIP):.*?evidences[\\/](\S+)\s+http_request:\s+(\S+)\s+([^\s]+(?:etc\/(?:passwd|shadow|group))[^\s]*)\s+HTTP\/[0-9.]+\s+from:\s+([0-9a-fA-F:\.]+)\s+code:\s*(200)\b(?:\s+user_agent:\s*(.+))?
action=write dataset/fer-web-result.log $1 [RECON: lfi_file_access] (source: $2) $3 $4 from $5 returned $6 ua:$7

###############################################################################
# web login POST attempts (wp-login.php / login.php)
###############################################################################
type=SingleWithSuppress
ptype=RegExp
desc=POST requests to login pages (wp-login.php / login.php)
pattern=(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\+\d{2}:\d{2})\s+\S+\s+(?:OS|GZIP):.*?evidences[\\/](\S+)\s+http_request:\s+(POST)\s+([^\s]*?(?:wp-login\.php|login\.php)[^\s]*)\s+HTTP\/[0-9.]+\s+from:\s+([0-9a-fA-F:\.]+)\s+code:\s*(\d{3})(?:\s+user_agent:\s*(.+))?
action=write dataset/fer-web-result.log $1 [RECON: burst_login_post] (source: $2) $3 $4 from $5 returned $6 ua:$7
window=120

###############################################################################
# WPScan detection
###############################################################################
type=SingleWithSuppress
ptype=RegExp
desc=Detect WPScan
pattern=(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\+\d{2}:\d{2})\s+\S+\s+(?:OS|GZIP):.*evidences[\\/](\S+)\s+http_request:.*from:\s+(\S+).*user_agent:\s+([^\r\n]*wpscan[^\r\n]*)
action=write dataset/fer-web-result.log $1 [RECON: scanner_detected] (source: $2) Suspicious scan activity detected from $3, UA: "$4"
window=30
###############################################################################
# Nikto detection
###############################################################################
type=SingleWithSuppress
ptype=RegExp
desc=Detect Nikto
pattern=(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\+\d{2}:\d{2})\s+\S+\s+(?:OS|GZIP):.*evidences[\\/](\S+)\s+http_request:.*from:\s+(\S+).*user_agent:\s+([^\r\n]*nikto[^\r\n]*)
action=write dataset/fer-web-result.log $1 [RECON: scanner_detected] (source: $2) Suspicious scan activity detected from $3, UA: "$4"
window=30
###############################################################################
# SQLmap detection
###############################################################################
type=SingleWithSuppress
ptype=RegExp
desc=Detect SQLMap
pattern=(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\+\d{2}:\d{2})\s+\S+\s+(?:OS|GZIP):.*evidences[\\/](\S+)\s+http_request:.*from:\s+(\S+).*user_agent:\s+([^\r\n]*sqlmap[^\r\n]*)
action=write dataset/fer-web-result.log $1 [RECON: scanner_detected] (source: $2) Suspicious scan tool detected from $3 → UA: "$4"
window=30
###############################################################################
# Nmap detection
###############################################################################
type=SingleWithSuppress
ptype=RegExp
desc=Detect Nmap
pattern=(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\+\d{2}:\d{2})\s+\S+\s+(?:OS|GZIP):.*evidences[\\/](\S+)\s+http_request:.*from:\s+(\S+).*user_agent:\s+([^\r\n]*nmap[^\r\n]*)
action=write dataset/fer-web-result.log $1 [RECON: scanner_detected] (source: $2) Suspicious scan tool detected from $3 → UA: "$4"
window=30
###############################################################################
# Hydra detection
###############################################################################
type=SingleWithSuppress
ptype=RegExp
desc=Detect Nikto
pattern=(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\+\d{2}:\d{2})\s+\S+\s+(?:OS|GZIP):.*evidences[\\/](\S+)\s+http_request:.*from:\s+(\S+).*user_agent:\s+([^\r\n]*hydra[^\r\n]*)
action=write dataset/fer-web-result.log $1 [RECON: scanner_detected] (source: $2) Suspicious scan activity detected from $3, UA: "$4"
window=30

###############################################################################
# Apache: 404 detection (for dirb scans)
###############################################################################
type=SingleWithSuppress
ptype=RegExp
desc=Apache single 404
pattern=(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\+\d{2}:\d{2})\s+\S+\s+(?:OS|GZIP):.*evidences[\\/](\S+)\s+http_request:.*\s+from:\s+(\S+)\s+code:\s+404
action=write dataset/fer-web-result.log $1 [RECON: dirb_scan] (source: $2) 404 response detected from $3
window=340

###############################################################################
# Sequence correlation: login cyberpanel
###############################################################################
type=PairWithWindow
ptype=RegExp
desc=Event 1 for cyberpanel login 
pattern=(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\+\d{2}:\d{2}).*cyberpanel.*http_request:\s+POST.*verifyLogin.*from:\s+(\S+)
action=continue
ptype2=RegExp
desc2=Event 2 for cyberpanel login 
pattern2=(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\+\d{2}:\d{2}).*cyberpanel.*http_request:\s+GET.*websiteFunctions.*from:\s+(\S+)
action2=event $1 SEQ_MATCH_CYBERPANEL from %2
window=120

type=SingleWithThreshold
ptype=RegExp
desc=Count SEQ_MATCH_CYBERPANEL events cyberpanel
pattern=(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\+\d{2}:\d{2}) SEQ_MATCH_CYBERPANEL from (\S+)
window=20
thresh=1
action=write dataset/fer-web-result.log $1 [PRIV_ESC: webmin_login] cyberpanel login sequences detected from $2

###############################################################################
# Sequence correlation: GET /?p=5 → POST /wp-admin/admin-ajax.php (webshell upload)
###############################################################################
type=PairWithWindow
ptype=RegExp
desc=Event 1 for webshell upload 
pattern=(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\+\d{2}:\d{2}).*http_request:\s+GET\s+/\?p=5.*from:\s+(\S+)
action=continue
ptype2=RegExp
desc2=Event 2 for webshell upload 
pattern2=(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\+\d{2}:\d{2}).*http_request:\s+POST\s+/wp-admin/admin-ajax\.php.*from:\s+(\S+)
action2=event $1 SEQ_MATCH_WEBSHELL_UPLOAD from %2
window=10

type=SingleWithThreshold
ptype=RegExp
desc=Count SEQ_MATCH_WEBSHELL_UPLOAD events
pattern=(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\+\d{2}:\d{2}) SEQ_MATCH_WEBSHELL_UPLOAD from (\S+)
window=10
thresh=1
action=write dataset/fer-web-result.log $1 [RECON: webshell_upload_seq] webshell upload sequences detected from $2

###############################################################################
# HTTP POST with suspisious user_agent
###############################################################################
type=Single
ptype=RegExp
desc=Detect POST request where user_agent contains common scripting/agent tokens (python|perl|postman|curl|wget|go-http-client|java|shell|httpclient)
pattern=(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\+\d{2}:\d{2})\s+\S+\s+(?:OS|GZIP):.*evidences[\\/](\S+)\s+http_request:\s+POST\b.*\sfrom:\s+(\d{1,3}(?:\.\d{1,3}){3})\b.*user_agent:\s+((?i)\S*(?:python|perl|postman|curl|wget|go-http-client|java|shell|-|httpclient)\S*)
action=write dataset/fer-web-result.log $1 [RECON: suspicious_post] (source: $2) POST request from $3 with "$4" user agent detected
###############################################################################
# HTTP HEAD with suspisious user_agent
###############################################################################
type=Single
ptype=RegExp
desc=Detect HEAD request where user_agent contains common scripting/agent tokens (python|perl|postman|curl|wget|go-http-client|java|shell|httpclient)
pattern=(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\+\d{2}:\d{2})\s+\S+\s+(?:OS|GZIP):.*evidences[\\/](\S+)\s+http_request:\s+HEAD\b.*\sfrom:\s+(\d{1,3}(?:\.\d{1,3}){3})\b.*user_agent:\s+((?i)\S*(?:python|perl|postman|curl|wget|go-http-client|java|shell|-|httpclient)\S*)
action=write dataset/fer-web-result.log $1 [RECON: suspicious_head] (source: $2) HEAD request from $3 with "$4" user agent detected

###############################################################################
# systemd activity related to user session/login
###############################################################################
type=Single
ptype=RegExp
desc=Systemd user session events (Created slice / Started Session)
pattern=(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\+\d{2}:\d{2})\s+\S+\s+(?:OS|GZIP):.*evidences[\\/](\S+)\s+\[(systemd|systemd-logind)\s+pid:\s+\d+\]\s+(Created slice User Slice of (\S+)|Started Session \S+ of user (\S+))
action=write dataset/fer-web-result.log $1 [PRIV_ESC: sys_user_session] (source: $2) Systemd user session event detected: "$4"
###############################################################################
# systemd activity related to New Session
###############################################################################
type=Single
ptype=RegExp
desc=Systemd new session event
pattern=(\d{4}-\d{2}-\d{2}T\d+:\d+:\d+\+\d+:\d+)\s+text/syslog_traditional\s+(?:OS|GZIP):.*evidences[\\/](\S+)\s+\[systemd-logind\s+pid:\s+\d+\]\s+New session \S+ of user (\S+)
action=write dataset/fer-web-result.log $1 [PRIV_ESC: sys_user_session] (source: $2) Systemd new session opened for user $3


###############################################################################
# sudo command detection
###############################################################################
type=Single
ptype=RegExp
desc=Sudo activity in /var/www
pattern=(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\+\d{2}:\d{2})\s+\S+\s+(?:OS|GZIP):.*?evidences[\\/](\S+)\s+\[sudo\]\s+(\S+)\s+:.*?PWD=([^;]+)\s+;\s+USER=(\S+)(?:\s*;\s*\S+=[^;]+)*\s*;\s*COMMAND=([^\r\n]+)
action=write dataset/fer-web-result.log $1 [PRIV_ESC: sys_sudo_exec] (source: $2) User $3 executed "$6" as $5 in $4

###############################################################################
# log with "systemd" and "Failed"
###############################################################################
type=Single
ptype=RegExp
desc=Systemd failure event
pattern=(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\+\d{2}:\d{2})\s+\S+\s+(?:OS|GZIP):.*evidences[\\/](\S+).*systemd.*Failed.*
action=write dataset/fer-web-result.log $1 [PRIV_ESC: sys_serv_fail] (source: $2) Systemd failure event detected
###############################################################################
# log with "systemd" and "Permission denied"
###############################################################################
type=Single
ptype=RegExp
desc=Systemd permission denied event
pattern=(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\+\d{2}:\d{2})\s+\S+\s+(?:OS|GZIP):.*evidences[\\/](\S+).*systemd.*Permission denied.*
action=write dataset/fer-web-result.log $1 [PRIV_ESC: sys_permit_fail] (source: $2) Systemd permission denied event detected

# COMMAND STRINGS
# sysinfo: "id", "whoami", "uname", "date", "cal", "uptime", "who", "w", "last", "finger", "lsb_release", "clear"
# network_conf: "netstat", "ip", "ifconfig", "ss"
# file_command: "ls", "find", "chmod", "chown", "rm", "mv", "echo", "base64"
# file_read: "cat", "head", "tail", "less", "more", "strings"
# file_download: "wget", "curl", "fetch"
# process_command: "ps", "top", "tmux", "screen"
# database: "mysql", "psql", "pgsql", "mongo", "redis-cli"
# file_compress_decompress: "tar", "zip", "unzip", "7z", "rar"
# shell_exec: "bash", "sh", ".sh" 
# code_exec: "perl", "python", "python3", "php", "ruby", "lua", "gcc"
# network_shell: "nc", "socat", "ssh", 
# network_scan: "nmap", "masscan"
# network_sniff_firewall: "tcpdump", "wireshark", "tshark", "ettercap", "dsniff", "iptables", "ufw", "firewalld"
# password_crack: "hydra", "medusa", "john", "hashcat"
# debugger: "gdb", "strace", "ltrace"
# service_management: "systemctl", "service", "init.d", "rc.d"
# container_mgmt: "docker", "kubectl", "helm"
# vcs_tool: "git", "svn", "hg"

###############################################################################
# sysinfo command in payload 
# ["id"/"whoami"/"uname"/"date"/"cal"/"uptime"/"who"/"w"/"last"/"finger"/"lsb_release"]
###############################################################################
type=Single
ptype=RegExp
desc=Apache access suspicious PHP request (system info commands)
pattern=(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\+\d{2}:\d{2})\s+\S+\s+(?:OS|GZIP):.*evidences[\\/](\S+)\s+http_request:\s+.*\.php.*\s+from:\s+(\S+).*DECODED:\s+\["(id|whoami|uname|date|cal|uptime|who|w|last|finger|clear|lsb_release)"(?:,\s*([^\]]*?))?\]\]+\s*(?:\[ALL_TRIES|$)
action=write dataset/fer-web-result.log $1 [EXPLOIT: sysinfo] (source: $2) Suspicious PHP request executing ["$4", $5] from $3
###############################################################################
# file read command in payload  
# ["cat"/"head"/"tail"/"less"/"more"/"strings", <file>]
###############################################################################
type=Single
ptype=RegExp
desc=Apache access suspicious PHP request (file read commands)
pattern=(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\+\d{2}:\d{2})\s+\S+\s+(?:OS|GZIP):.*evidences[\\/](\S+)\s+http_request:\s+.*\.php.*\s+from:\s+(\S+).*DECODED:\s+\["(cat|head|tail|less|more|strings)"(?:,\s*([^\]]*?))?\]\]+\s*(?:\[ALL_TRIES|$)
action=write dataset/fer-web-result.log $1 [EXPLOIT: file_read] (source: $2) Suspicious PHP request executing ["$4", $5] from $3
###############################################################################
# network_conf command in payload
# ["netstat"/"ip"/"ifconfig"/"ss", <args>]
###############################################################################
type=Single
ptype=RegExp
desc=Apache access suspicious PHP request (network commands)
pattern=(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\+\d{2}:\d{2})\s+\S+\s+(?:OS|GZIP):.*evidences[\\/](\S+)\s+http_request:\s+.*\.php.*\s+from:\s+(\S+).*DECODED:\s+\["(netstat|ip|ifconfig|ss)"(?:,\s*([^\]]*?))?\]\]+\s*(?:\[ALL_TRIES|$)
action=write dataset/fer-web-result.log $1 [EXPLOIT: network_conf] (source: $2) Suspicious PHP request executing ["$4", $5] from $3
###############################################################################
# process_command in payload
# ["ps"/"top"/"tmux"/"screen", <args>]
###############################################################################
type=Single
ptype=RegExp
desc=Apache access suspicious PHP request (process/session commands)
pattern=(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\+\d{2}:\d{2})\s+\S+\s+(?:OS|GZIP):.*evidences[\\/](\S+)\s+http_request:\s+.*\.php.*\s+from:\s+(\S+).*DECODED:\s+\["(ps|top|tmux|screen)"(?:,\s*([^\]]*?))?\]\]+\s*(?:\[ALL_TRIES|$)
action=write dataset/fer-web-result.log $1 [EXPLOIT: process_command] (source: $2) Suspicious PHP request executing ["$4", $5] from $3
###############################################################################
# file_command in payload
# ["ls"/"find"/"chmod"/"chown"/"rm"/"mv"/"echo"/"base64", <args>...]
###############################################################################
type=Single
ptype=RegExp
desc=Apache access suspicious PHP request (filesystem / misc commands)
pattern=(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\+\d{2}:\d{2})\s+\S+\s+(?:OS|GZIP):.*evidences[\\/](\S+)\s+http_request:\s+.*\.php.*\s+from:\s+(\S+).*DECODED:\s+\["(ls|find|chmod|chown|rm|mv|echo|base64)"(?:,\s*([^\]]*?))?\]\]+\s*(?:\[ALL_TRIES|$)
action=write dataset/fer-web-result.log $1 [EXPLOIT: file_command] (source: $2) Suspicious PHP request executing ["$4", $5] from $3
###############################################################################
# database command in payload
# ["mysql"/"psql"/"pgsql"/"mongo"/"redis-cli", <args>...]
###############################################################################
type=Single
ptype=RegExp
desc=Apache access suspicious PHP request (database command)
pattern=(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\+\d{2}:\d{2})\s+\S+\s+(?:OS|GZIP):.*evidences[\\/](\S+)\s+http_request:\s+.*\.php.*\s+from:\s+(\S+).*DECODED:\s+\["(mysql|psql|pgsql|mongo|redis-cli)"(?:,\s*([^\]]*?))?\]\]+\s*(?:\[ALL_TRIES|$)
action=write dataset/fer-web-result.log $1 [EXPLOIT: database] (source: $2) Suspicious PHP request executing ["$4", $5] from $3
###############################################################################
# file_download command in payload 
# ["wget"/"curl"/"fetch", <url>]
###############################################################################
type=Single
ptype=RegExp
desc=Apache access suspicious PHP request (download command)
pattern=(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\+\d{2}:\d{2})\s+\S+\s+(?:OS|GZIP):.*evidences[\\/](\S+)\s+http_request:\s+.*\.php.*\s+from:\s+(\S+).*DECODED:\s+\["(wget|curl|fetch)"(?:,\s*([^\]]*?))?\]\]+\s*(?:\[ALL_TRIES|$)
action=write dataset/fer-web-result.log $1 [EXPLOIT: file_download] (source: $2) Suspicious PHP request executing ["$4", $5] from $3
###############################################################################
# file_compress_decompress command in payload
# ["tar"/"zip"/"unzip"/"7z"/"rar", <args>...]
###############################################################################
type=Single
ptype=RegExp
desc=Apache access suspicious PHP request (archive command)
pattern=(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\+\d{2}:\d{2})\s+\S+\s+(?:OS|GZIP):.*evidences[\\/](\S+)\s+http_request:\s+.*\.php.*\s+from:\s+(\S+).*DECODED:\s+\["(tar|zip|unzip|7z|rar)"(?:,\s*([^\]]*?))?\]\]+\s*(?:\[ALL_TRIES|$)
action=write dataset/fer-web-result.log $1 [EXPLOIT: file_compress_decompress] (source: $2) Suspicious PHP request executing ["$4", $5] from $3
###############################################################################
# shell script execution in payload
# ["./*.sh", <args>]
###############################################################################
type=Single
ptype=RegExp
desc=Apache access suspicious PHP request (shell script execution)
pattern=(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\+\d{2}:\d{2})\s+\S+\s+(?:OS|GZIP):.*evidences[\\/](\S+)\s+http_request:\s+.*\.php.*\s+from:\s+(\S+).*DECODED:\s+\["([^"]+\.sh)"(?:,\s*([^\]]*?))?\]\]+\s*(?:\[ALL_TRIES|$)
action=write dataset/fer-web-result.log $1 [PRIV_ESC: shell_exec] (source: $2) Suspicious PHP request executing ["$4", $5] from $3
###############################################################################
# shell execution in payload
# ["bash"/"sh", <args>...]
###############################################################################
type=Single
ptype=RegExp
desc=Apache access suspicious PHP request (bash/sh execution)
pattern=(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\+\d{2}:\d{2})\s+\S+\s+(?:OS|GZIP):.*evidences[\\/](\S+)\s+http_request:\s+.*\.php.*\s+from:\s+(\S+).*DECODED:\s+\["(bash|sh)"(?:,\s*([^\]]*?))?\]\]+\s*(?:\[ALL_TRIES|$)
action=write dataset/fer-web-result.log $1 [PRIV_ESC: shell_exec] (source: $2) Suspicious PHP request executing ["$4", $5] from $3
###############################################################################
# code execution in payload
# ["perl"/"python"/"python3"/"php"/"ruby"/"lua"/"gcc", <args>...]
###############################################################################
type=Single
ptype=RegExp
desc=Apache access suspicious PHP request (interpreter/compiler execution)
pattern=(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\+\d{2}:\d{2})\s+\S+\s+(?:OS|GZIP):.*evidences[\\/](\S+)\s+http_request:\s+.*\.php.*\s+from:\s+(\S+).*DECODED:\s+\["(perl|python3?|php|ruby|lua|gcc)"(?:,\s*([^\]]*?))?\]\]+\s*(?:\[ALL_TRIES|$)
action=write dataset/fer-web-result.log $1 [PRIV_ESC: code_exec] (source: $2) Suspicious PHP request executing ["$4", $5] from $3
###############################################################################
# network shell command in payload
# ["nc"/"socat"/"ssh", <args>...]
###############################################################################
type=Single
ptype=RegExp
desc=Apache access suspicious PHP request (nc/socat/ssh)
pattern=(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\+\d{2}:\d{2})\s+\S+\s+(?:OS|GZIP):.*evidences[\\/](\S+)\s+http_request:\s+.*\.php.*\s+from:\s+(\S+).*DECODED:\s+\["(nc|socat|ssh)"(?:,\s*([^\]]*?))?\]\]+\s*(?:\[ALL_TRIES|$)
action=write dataset/fer-web-result.log $1 [PRIV_ESC: network_shell] (source: $2) Suspicious PHP request executing ["$4", $5] from $3
###############################################################################
# network scan command in payload
# ["nmap"/"masscan", <args>...]
###############################################################################
type=Single
ptype=RegExp
desc=Apache access suspicious PHP request (nmap/masscan)
pattern=(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\+\d{2}:\d{2})\s+\S+\s+(?:OS|GZIP):.*evidences[\\/](\S+)\s+http_request:\s+.*\.php.*\s+from:\s+(\S+).*DECODED:\s+\["(nmap|masscan)"(?:,\s*([^\]]*?))?\]\]+\s*(?:\[ALL_TRIES|$)
action=write dataset/fer-web-result.log $1 [EXPLOIT: network_scan] (source: $2) Suspicious PHP request executing ["$4", $5] from $3
###############################################################################
# network sniffing/firewall command in payload
# ["tcpdump"/"wireshark"/"tshark"/"ettercap"/"dsniff"/"iptables"/"ufw"/"firewalld", <args>...]
###############################################################################
type=Single
ptype=RegExp
desc=Apache access suspicious PHP request (sniffing/firewall tools)
pattern=(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\+\d{2}:\d{2})\s+\S+\s+(?:OS|GZIP):.*evidences[\\/](\S+)\s+http_request:\s+.*\.php.*\s+from:\s+(\S+).*DECODED:\s+\["(tcpdump|wireshark|tshark|ettercap|dsniff|iptables|ufw|firewalld)"(?:,\s*([^\]]*?))?\]\]+\s*(?:\[ALL_TRIES|$)
action=write dataset/fer-web-result.log $1 [EXPLOIT: network_sniff_firewall] (source: $2) Suspicious PHP request executing ["$4", $5] from $3
###############################################################################
# password cracking command in payload
# ["hydra"/"medusa"/"john"/"hashcat", <args>...]
###############################################################################
type=Single
ptype=RegExp
desc=Apache access suspicious PHP request (password cracking tools)
pattern=(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\+\d{2}:\d{2})\s+\S+\s+(?:OS|GZIP):.*evidences[\\/](\S+)\s+http_request:\s+.*\.php.*\s+from:\s+(\S+).*DECODED:\s+\["(hydra|medusa|john|hashcat)"(?:,\s*([^\]]*?))?\]\]+\s*(?:\[ALL_TRIES|$)
action=write dataset/fer-web-result.log $1 [PRIV_ESC: password_crack] (source: $2) Suspicious PHP request executing ["$4", $5] from $3
###############################################################################
# debugger command in payload
# ["gdb"/"strace"/"ltrace", <args>...]
###############################################################################
type=Single
ptype=RegExp
desc=Apache access suspicious PHP request (debugging tools)
pattern=(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\+\d{2}:\d{2})\s+\S+\s+(?:OS|GZIP):.*evidences[\\/](\S+)\s+http_request:\s+.*\.php.*\s+from:\s+(\S+).*DECODED:\s+\["(gdb|strace|ltrace)"(?:,\s*([^\]]*?))?\]\]+\s*(?:\[ALL_TRIES|$)
action=write dataset/fer-web-result.log $1 [EXPLOIT: debugger] (source: $2) Suspicious PHP request executing ["$4", $5] from $3
###############################################################################
# service management command in payload
# ["systemctl"/"service"/"init.d"/"rc.d", <args>...]
###############################################################################
type=Single
ptype=RegExp
desc=Apache access suspicious PHP request (service management tools)
pattern=(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\+\d{2}:\d{2})\s+\S+\s+(?:OS|GZIP):.*evidences[\\/](\S+)\s+http_request:\s+.*\.php.*\s+from:\s+(\S+).*DECODED:\s+\["(systemctl|service|init\.d|rc\.d)"(?:,\s*([^\]]*?))?\]\]+\s*(?:\[ALL_TRIES|$)
action=write dataset/fer-web-result.log $1 [EXPLOIT: service_management] (source: $2) Suspicious PHP request executing ["$4", $5] from $3
###############################################################################
# container management command in payload
# ["docker"/"kubectl"/"helm", <args>...]
###############################################################################
type=Single
ptype=RegExp
desc=Apache access suspicious PHP request (container/orchestration tools)
pattern=(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\+\d{2}:\d{2})\s+\S+\s+(?:OS|GZIP):.*evidences[\\/](\S+)\s+http_request:\s+.*\.php.*\s+from:\s+(\S+).*DECODED:\s+\["(docker|kubectl|helm)"(?:,\s*([^\]]*?))?\]\]+\s*(?:\[ALL_TRIES|$)
action=write dataset/fer-web-result.log $1 [EXPLOIT: container_mgmt] (source: $2) Suspicious PHP request executing ["$4", $5] from $3
###############################################################################
# vcs tool command in payload
# ["git"/"svn"/"hg", <args>...]
###############################################################################
type=Single
ptype=RegExp
desc=Apache access suspicious PHP request (version control tools)
pattern=(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\+\d{2}:\d{2})\s+\S+\s+(?:OS|GZIP):.*evidences[\\/](\S+)\s+http_request:\s+.*\.php.*\s+from:\s+(\S+).*DECODED:\s+\["(git|svn|hg)"(?:,\s*([^\]]*?))?\]\]+\s*(?:\[ALL_TRIES|$)
action=write dataset/fer-web-result.log $1 [EXPLOIT: vcs_tool] (source: $2) Suspicious PHP request executing ["$4", $5] from $3
